{% extends "base_generic.html" %}

{% block content %}

<div class="row g-0">

  <div class="col-lg-6 pe-lg-2 mb-3">
    <div class="card h-lg-100 overflow-hidden">
      <div class="card-header bg-light">
        <div class="row align-items-center">
          <div class="col">
            <h6 class="mb-0">My Tips</h6>
          </div>
          <div class="col-auto text-center pe-x1">
            <br><br>
          </div>
        </div>
      </div>
      <div class="card-body p-0">

        <div class="tips-status">
          <canvas class="my-4 w-100" id="tipsChart" width="200" height="100"></canvas>
        </div>
      </div>
      <div class="card-footer bg-light p-0"><a class="btn btn-sm btn-link d-block w-100 py-2" href="/tips">Submit Tips<span class="fas fa-chevron-right ms-1 fs--2"></span></a></div>
    </div>
  </div>

  <div class="col-lg-6 pe-lg-2 mb-3">
    <div class="card h-lg-100 overflow-hidden">
      <div class="card-header bg-light">
        <div class="row align-items-center">
          <div class="col">
            <h6 class="mb-0">My Tasks</h6>
          </div>
          <div class="col-auto text-center pe-x1">
            <br><br>
          </div>
        </div>
      </div>
      <div class="card-body p-0">
        <div class="list-group w-auto rounded-0">
          {% for task in task_list %}
            {% if not task.date_done != undefined %}
            <label class="list-group-item d-flex gap-3">
              <span class="pt-1 form-checked-content">
                {{ task.title }}
                <small class="d-block text-muted" style="margin: 0.1rem 0;">
                  <span data-feather="user" class="align-text-bottom"></span>
                  {{ task.assignees|join:", " }}
                </small>
              </span>
            </label>
            {% endif %}
          {% endfor %}
        </div>
        <div class="card-footer bg-light p-0"><a class="btn btn-sm btn-link d-block w-100 py-2" href="/tasks/overview">See all tasks<span class="fas fa-chevron-right ms-1 fs--2"></span></a></div>
      </div>
    </div>
  </div>
</div>
<div class="row g-1">
  <div class="col-lg-6 pe-lg-2 mb-3">
    <div class="card h-lg-100 overflow-hidden">
      <div class="card-header bg-light">
        <div class="row align-items-center">
          <div class="col">
            <h6 class="mb-0">Next Shifts</h6>
          </div>
          <div class="col-auto text-center pe-x1">
            <br><br>
          </div>
        </div>
      </div>
      <div class="card-body p-0">
        <ul class="shifts">
        {% for shift in nextShifts %}
          <li>
            <div class="date">
              {{ shift.day }}
              <span class="weekday">{{ shift.weekday }}</span>
            </div>
            <div class="shift">
              <span class="time">{{ shift.start }} – {{ shift.end }}</span>
              <span class="location">iaro, Sophienstraße</span>
            </div>
          </li>
        {% endfor %}
        </ul>
      </div>
    </div>
  </div>
</div>




<style>
  .btn-link {
    text-decoration: none;
  }
  .tips-status {
    display: flex;
    padding: 0rem 1rem;
  }
  ul.shifts {
    list-style: none;
    padding: 0;
    margin-top: 0.5rem;
  }
  ul.shifts li {
    display: flex;
    align-items: center;
    margin: 0.25rem 1rem 0.25rem 0;
  }
  ul.shifts li .date {
    padding: 1rem;
    font-size: 1.4rem;
    font-weight: 600;
    display: flex;
    flex-direction: column;
    align-items: center;
  }
  ul.shifts li .date .weekday {
    font-size: 0.7rem;
    color: #969696;
    font-weight: 600;
    margin-top: -0.4rem;
  }
  ul.shifts li .shift {
    background: #feebef;
    padding: 0.7rem 1.4rem;
    border-radius: 5px;
    display: flex;
    flex-direction: column;
    width: 100%;
  }
  ul.shifts li .shift .time {
    font-size: 1rem;
    font-weight: 600;
    color: #d35d7d;
  }
  ul.shifts li .shift .location {
    color: #8a7f82;
  }
</style>

{% load static %}
<script src="{% static 'js/chartjs-4.2.0.min.js' %}"></script>
<script language="javascript">
  (() => {
    'use strict'
    // Graphs
    const ctx = document.getElementById('tipsChart')
    // eslint-disable-next-line no-unused-vars
    const myChart = new Chart(ctx, {
      type: 'bar',
      data: {
        datasets: [{
          data: {{ tipsEval | safe }},
        }]
      },
      options: {
        scales: {
          y: {
            ticks: {
              stepSize: 5,
              beginAtZero:true,
              callback: function(value, index, values) {
                      return value + ' €';
              }
            },
          },
          x: {
            ticks: {
              callback: function(value, index, values) {
                      return this.getLabelForValue (value) + ' KW';
              }
            },
          }
        },
        plugins: {
          legend: {
              display: false
          }
        }
      }
    })
  })()
</script>
{% endblock %}