{% extends "base_generic.html" %}

{% block content %}

<div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pb-2 mb-3 border-bottom">        
  <h1 class="h2">Inventory Overview</h1>
  <div class="btn-toolbar mb-2 mb-md-0">
    <button type="button" class="btn btn-sm btn-outline-secondary">
      <span data-feather="calendar" class="align-text-bottom"></span>
      Last updated: {{ modifiedDate }}
    </button>
  </div>
</div>

<div style="width: 100%;">
  <table class="table table-striped table-hover">
    <tbody>
      {% for branch in branches%}
        <tr class="title">
          <th colspan="3">{{ branch }}</th>
        </tr>
        <tr class="header thead-dark">
          <th scope="col">Name</th>
          <th scope="col">Storage</th>
          <th scope="col" style="white-space: nowrap;">Availability</th>
        </tr>
        {% for product in products %}
          {% for storage in product.storages %}
            {% if storage in branch.get_storages %}
            <tr>
              <td>{{ product.name }}</td>
              {% for storage in product.storages %}
                {% if storage in branch.get_storages %}
                <td style="display: flex;">
                  <span class="badge bg-secondary-subtle border border-secondary-subtle text-secondary-emphasis">
                    <svg class="bi ms-1" width="16" height="16" style="color: {{ storage.color }};">
                      <use xlink:href="#x-circle-fill">
                        <symbol id="x-circle-fill" viewBox="0 0 16 16">
                          <circle cx="8" cy="8" r="7" />
                        </symbol>
                      </use>
                     </svg>
                    {{ storage }}
                  </span>
                </td>
                {% endif %}
              {% endfor %}
              <td>{{ product.value_tobuy|floatformat:2 }} {{ product.unit.all|join:", " }}</td>
            </tr>
            {% endif %}
          {% endfor %}
        {% endfor %}
      {% endfor %}
    </tbody>
  </table>
</div>

<style>
  .table {
    margin-bottom: 2rem !important;
    font-size: 1rem;
  }
  td {
    padding: 0.8rem !important;
    overflow-wrap: anywhere;
    padding: .9rem;
    height: 100%;
  }
  tr.title th {
    padding-top: 3rem !important;
    font-size: 1.5rem !important;
    font-weight: 200 !important;
  }
  tr.header th {
    color: #495057 !important;
    background-color: #e9ecef;
    border-color: #dee2e6;
  }
  tr.title:first-child th {
    padding-top: 1rem !important;
  }
  tbody tr.header:hover, tbody tr.title:hover {
    background-color: white !important;
    box-shadow: none !important;
  }
  .table > :not(caption) > * > * {
    box-shadow: none !important;
  }
  .badge {
    display: flex;
    gap: 0.5rem;
    flex-direction: row;
    align-items: center;
    font-size: 0.85rem;
    padding-right: 0.7rem;
    font-weight: 500;
  }
</style>
{% endblock %}