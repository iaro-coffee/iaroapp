{% extends "base_generic.html" %}

{% block content %}

<div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pb-2 mb-3 border-bottom">        
  <h1 class="h2">Tips Overview</h1>
  <div class="btn-toolbar mb-2 mb-md-0">
    <div class="btn-group me-2">
      <button type="button" class="btn btn-sm btn-outline-secondary">Share</button>
      <button type="button" class="btn btn-sm btn-outline-secondary">Export</button>
    </div>
    <button type="button" class="btn btn-sm btn-outline-secondary dropdown-toggle">
      <span data-feather="calendar" class="align-text-bottom"></span>
      This week
    </button>
  </div>
</div>

<canvas class="my-4 w-100" id="tipsChart" width="900" height="380"></canvas>

<div style="width: 100%;">
  <table class="table table-striped table-hover">
    <thead>
      <tr>
        <th scope="col" width="100%">Name</th>
        <th scope="col">Today</th>
        <th scope="col">This month</th>
        <th scope="col">Last month</th>
      </tr>
    </thead>
    <tbody>
      {% for user in evaluation %}
      <tr>
        <td>
          {% if user.user_firstname and user.user_lastname %}
            {{ user.user_firstname }} {{ user.user_lastname }}
          {% else %}
            {{ user.user_name }}
          {% endif %}
        </th>
        <td>{{ user.amountToday|floatformat:2 }} €</td>
        <td>{{ user.amountThisMonth|floatformat:2 }} €</td>
        <td>{{ user.amountLastMonth|floatformat:2 }} €</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>

<div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">        
  <h1 class="h2">Latest Tips</h1>
  <div class="btn-toolbar mb-2 mb-md-0">
    <div class="btn-group me-2">
      <button type="button" class="btn btn-sm btn-outline-secondary">Share</button>
      <button type="button" class="btn btn-sm btn-outline-secondary">Export</button>
    </div>
    <button type="button" class="btn btn-sm btn-outline-secondary dropdown-toggle">
      <span data-feather="calendar" class="align-text-bottom"></span>
      This week
    </button>
  </div>
</div>

<div class="table-responsive" style="width: 100%;">
  <table class="table table-striped table-sm table-hover">
    <thead>
      <tr>
        <th scope="col" width="100%">Name</th>
        <th scope="col">Amount</th>
        <th scope="col">Date</th>
      </tr>
    </thead>
    <tbody>
      {% for tip in latestTips %}
      <tr>
        <td>
          {{ tip.user }}
        </th>
        <td>{{ tip.amount|floatformat:2 }} €</td>
        <td>{{ tip.date }}</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>

{% load static %}
<script src="{% static 'js/chartjs-4.2.0.min.js' %}"></script>
<script language="javascript">
  (() => {
    'use strict'
    // Graphs
    const ctx = document.getElementById('tipsChart')
    // eslint-disable-next-line no-unused-vars
    const myChart = new Chart(ctx, {
      type: 'bar',
      data: {
        labels: {{ chartLabels | safe }},
        datasets: [{
          data: {{ chartValues | safe }},
        }]
      },
      options: {
        plugins: {
          legend: {
              display: false
          }
        }
      }
    })
  })()
</script>

{% endblock %}